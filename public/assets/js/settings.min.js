document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("sidebar-toggle"),t=document.getElementById("sidebar"),s=document.getElementById("main-content");e&&t&&s&&e.addEventListener("click",function(){t.classList.toggle("sidebar-expanded"),s.classList.toggle("main-expanded")});const n=document.getElementById("mobile-nav-toggle");n&&t&&n.addEventListener("click",function(){t.classList.toggle("sidebar-visible")}),document.addEventListener("click",function(e){window.innerWidth<=768&&t&&t.classList.contains("sidebar-visible")&&!t.contains(e.target)&&n&&!n.contains(e.target)&&t.classList.remove("sidebar-visible")});const r=document.getElementById("profile-image-input"),i=document.getElementById("profile-image"),a=document.getElementById("change-image-btn");r&&i&&a&&(a.addEventListener("click",function(){r.click()}),r.addEventListener("change",function(){if(this.files&&this.files[0]){const e=new FileReader;e.onload=function(e){i.src=e.target.result,i.style.display="block",document.querySelector(".profile-image-placeholder").style.display="none"},e.readAsDataURL(this.files[0])}}));document.querySelectorAll(".custom-select").forEach(e=>{const t=e.querySelector(".custom-select-value"),s=e.nextElementSibling,n=s.querySelectorAll(".custom-select-option"),r=s.querySelector(".custom-select-search input"),i=e.parentElement.querySelector('input[type="hidden"]');e.addEventListener("click",function(t){t.stopPropagation(),s.style.display="block"===s.style.display?"none":"block","block"===s.style.display&&r&&r.focus();const n=e.querySelector(".custom-select-arrow");n&&(n.style.transform="block"===s.style.display?"rotate(180deg)":"rotate(0)")}),r&&(r.addEventListener("input",function(){const e=this.value.toLowerCase();n.forEach(t=>{t.textContent.toLowerCase().includes(e)?t.style.display="block":t.style.display="none"})}),r.addEventListener("click",function(e){e.stopPropagation()})),n.forEach(r=>{r.addEventListener("click",function(){t.textContent=this.textContent,i&&(i.value=this.dataset.value);const r=e.parentElement.nextElementSibling;r&&r.classList.contains("other-field")&&("other"===this.dataset.value?r.style.display="block":r.style.display="none"),n.forEach(e=>e.classList.remove("selected")),this.classList.add("selected"),s.style.display="none";const a=e.querySelector(".custom-select-arrow");a&&(a.style.transform="rotate(0)")})})}),document.addEventListener("click",function(){document.querySelectorAll(".custom-select-dropdown").forEach(e=>{e.style.display="none";const t=e.previousElementSibling;if(t){const e=t.querySelector(".custom-select-arrow");e&&(e.style.transform="rotate(0)")}})});const l=document.getElementById("settings-form");if(l){l.addEventListener("submit",function(e){let t=!0;this.querySelectorAll("[required]").forEach(e=>{if(e.value.trim())e.parentElement.classList.remove("has-error");else{t=!1,e.parentElement.classList.add("has-error");const s=e.parentElement.querySelector(".error-message");s&&(s.textContent="This field is required")}});const s=this.querySelector('input[type="email"]');if(s&&s.value.trim()){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s.value.trim())){t=!1,s.parentElement.classList.add("has-error");const e=s.parentElement.querySelector(".error-message");e&&(e.textContent="Please enter a valid email address")}}const n=this.querySelector("#sa-id-number");if(n&&n.value.trim()&&!/^\d{13}$/.test(n.value.trim())){t=!1,n.parentElement.classList.add("has-error");const e=n.parentElement.querySelector(".error-message");e&&(e.textContent="ID number should be 13 digits")}const r=this.querySelector("#password");if(r&&r.value.trim()){if(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(r.value)){t=!1,r.parentElement.classList.add("has-error");const e=r.parentElement.querySelector(".error-message");e&&(e.textContent="Password must be at least 8 characters and include uppercase, lowercase, number, and special character")}}if(!t){e.preventDefault();const t=this.querySelector(".has-error");t&&t.scrollIntoView({behavior:"smooth",block:"center"})}});l.querySelectorAll("input, select, textarea").forEach(e=>{e.addEventListener("blur",function(){if(this.parentElement.classList.remove("has-error"),this.hasAttribute("required")&&!this.value.trim()){this.parentElement.classList.add("has-error");const e=this.parentElement.querySelector(".error-message");return void(e&&(e.textContent="This field is required"))}if("email"===this.type&&this.value.trim()){if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.value.trim())){this.parentElement.classList.add("has-error");const e=this.parentElement.querySelector(".error-message");return void(e&&(e.textContent="Please enter a valid email address"))}}if("sa-id-number"===this.id&&this.value.trim()&&!/^\d{13}$/.test(this.value.trim())){this.parentElement.classList.add("has-error");const e=this.parentElement.querySelector(".error-message");return void(e&&(e.textContent="ID number should be 13 digits"))}if("password"===this.id&&this.value.trim()){if(!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(this.value)){this.parentElement.classList.add("has-error");const e=this.parentElement.querySelector(".error-message");return void(e&&(e.textContent="Password must be at least 8 characters and include uppercase, lowercase, number, and special character"))}}})})}document.querySelectorAll(".phone-input").forEach(e=>{e.addEventListener("input",function(e){let t=this.value.replace(/\D/g,"");t.length>10&&(t=t.substring(0,10)),t.length>6?this.value=t.substring(0,3)+" "+t.substring(3,6)+" "+t.substring(6):t.length>3?this.value=t.substring(0,3)+" "+t.substring(3):this.value=t})});document.querySelectorAll('input[type="date"]').forEach(e=>{if("dob"===e.id){const t=(new Date).toISOString().split("T")[0];e.setAttribute("max",t)}}),document.querySelectorAll("select").forEach(e=>{const t=e.getAttribute("data-other-field");if(t){const s=document.getElementById(t);s&&(s.style.display="Other"===e.value?"block":"none",e.addEventListener("change",function(){s.style.display="Other"===this.value?"block":"none","Other"===this.value&&s.focus()}))}})});